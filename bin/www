#!/usr/bin/env node

var debug = require('debug')('techparty-data:server');
var cluster = require('cluster');
var numCPUs = require('os').cpus().length;

// Include the cluster module
var cluster = require('cluster');

var cpuCount = require('os').cpus().length;

cluster.setupMaster({exec: 'app.js'});

for (var i = 0; i < cpuCount; i++) 
  cluster.fork();

// Listen for dying workers
cluster.on('exit', function (worker) {
    // Replace the dead worker, we're not sentimental
    console.log('Worker ' + worker.id + ' died :(');
    cluster.fork();
});